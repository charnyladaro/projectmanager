{% extends "base.html" %} {% block content %}

<div class="profile-container">
  <h1>{{ user.username }}'s Profile</h1>

  <div class="profile-picture">
    <img
      src="{{ url_for('static', filename='profile_pics/' + user.profile_picture) }}"
      alt="{{ user.username }}'s profile picture"
    />
  </div>
  <h1>{{ user.username }}'s Profile</h1>
  <p>
    Status: {% if user.is_active %}<span class="active-status">Active</span>{%
    else %}<span class="inactive-status">Inactive</span>{% endif %}
  </p>

  {% if current_user.id == user.id %}
  <button id="toggle-active-status" data-active="{{ user.is_active }}">
    {% if user.is_active %}Set Inactive{% else %}Set Active{% endif %}
  </button>
  {% endif %}
  <div class="user-info">
    <p><strong>Username:</strong> {{ user.username }}</p>
    <p><strong>Email:</strong> {{ user.email }}</p>
  </div>

  {% if current_user.id == user.id or current_user.is_admin %}
  <div class="edit-profile">
    <h2>
      {% if current_user.is_admin and current_user.id != user.id %}Edit {{
      user.username }}'s Profile{% else %}Edit Your Profile{% endif %}
    </h2>
    <form method="POST" enctype="multipart/form-data">
      {{ form.hidden_tag() }}
      <div>{{ form.username.label }} {{ form.username }}</div>
      <div>{{ form.email.label }} {{ form.email }}</div>
      <div>{{ form.password.label }} {{ form.password }}</div>
      <div>{{ form.profile_picture.label }} {{ form.profile_picture }}</div>
      <div>{{ form.submit }}</div>
    </form>
  </div>
  {% endif %} 
  {% if can_chat %}
  <a href="{{ url_for('chat', user_id=user.id) }}" class="btn btn-primary">Chat</a>
{% elif can_send_friend_request %}
  <form action="{{ url_for('send_request', receiver_id=user.id, request_type='friend') }}" method="POST">
      <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
      <button type="submit" class="btn btn-primary">Send Friend Request</button>
  </form>
{% endif %}

  <div class="user-activity">
    <h2>Recent Activity</h2>
    <ul>
      <li>Example activity 1</li>
      <li>Example activity 2</li>
      <li>Example activity 3</li>
    </ul>
  </div>

  {% if current_user.is_admin and current_user.id != user.id %}
  <div class="admin-controls">
    <h2>Admin Controls</h2>
    {% if not user.is_admin %}
    <form action="{{ url_for('make_admin', user_id=user.id) }}" method="POST">
      {{ form.csrf_token }}
      <button type="submit" class="btn btn-warning">Make Admin</button>
    </form>
    {% else %}
    <form action="{{ url_for('remove_admin', user_id=user.id) }}" method="POST">
      {{ form.csrf_token }}
      <button type="submit" class="btn btn-warning">Remove Admin</button>
    </form>
    {% endif %}
  </div>
  {% endif %}
</div>
{% endblock %}
